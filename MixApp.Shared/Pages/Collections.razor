@page "/Collections"
@inherits MixApp.Shared.Pages.CollectionsBase
@using System.Text.Json;

<div class="page">
    <div class="group">
        @foreach(var collection in Collections)
        {
            <FluentCard class="collection">
                <div class="content">
                    <div class="left">
                        <h2>@collection.Name</h2>
                        <p class="intro">@collection.Introduction</p>
                        <FluentButton Appearance="Appearance.Outline">Discover More</FluentButton>
                    </div>

                    <div class="right">
                        @foreach(Software software in JsonSerializer.Deserialize<List<Software>>(collection.Softwares!) ?? [])
                        {
                            @if(software.Pin ?? false)
                            {
                                <img id="@software.PackageIdentifier" class="icon" 
                                    src="@RemoteAssets.GetIcon(software)" 
                                    @onclick=@(_ => GlobalEvent.OpenSoftware(software))
                                    fetchpriority="low" loading="lazy" 
                                    onerror="javascript:this.src='https://www.conchbrain.club/favicon.ico'">
                                
                                <FluentTooltip Anchor="@software.PackageIdentifier">
                                    @software.PackageName
                                </FluentTooltip>
                            }
                        }
                    </div>
                </div>
            </FluentCard>
        }
    </div>
</div>

<style>
    .page {
        width: 100%;
        padding: 10px 20px;

        --bg: radial-gradient(closest-side,rgb(43, 66, 163),rgba(235,105,78,0)), 
            radial-gradient(closest-side,rgb(122, 64, 143),rgba(243,11,164,0)),
            radial-gradient(closest-side,rgb(91, 49, 160),rgba(254,234,131,0)),
            radial-gradient(closest-side,rgb(69, 143, 149),rgba(170,142,245,0)),
            radial-gradient(closest-side,rgb(59, 95, 147),rgba(248,192,147,0));
    }

    .page .group {
        width: 100%;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .page .collection {
        background-attachment: fixed;
        background-size: 130vmax 130vmax, 80vmax 80vmax, 90vmax 90vmax, 110vmax 110vmax, 90vmax 90vmax;
        background-position: -80vmax -80vmax, 60vmax -30vmax, 10vmax 10vmax, -30vmax -10vmax, 50vmax 50vmax;
        background-repeat: no-repeat;
        animation: 10s movement linear infinite;
        height: 220px;
        width: calc(50% - 6px);
        min-width: 580px;
        background-image: var(--bg);
    }

    @@keyframes movement {
        0%, 100% {
            background-size: 130vmax 130vmax, 80vmax 80vmax, 90vmax 90vmax, 110vmax 110vmax, 90vmax 90vmax;
            background-position: -80vmax -80vmax, 60vmax -30vmax, 10vmax 10vmax, -30vmax -10vmax, 50vmax 50vmax;
        }
        25% {
            background-size: 100vmax 100vmax, 90vmax 90vmax, 100vmax 100vmax, 90vmax 90vmax, 60vmax 60vmax;
            background-position: -60vmax -90vmax, 50vmax -40vmax, 0vmax -20vmax, -40vmax -20vmax, 40vmax 60vmax;
        }
        50% {
            background-size: 80vmax 80vmax, 110vmax 110vmax, 80vmax 80vmax, 60vmax 60vmax, 80vmax 80vmax;
            background-position: -50vmax -70vmax, 40vmax -30vmax, 10vmax 0vmax, 20vmax 10vmax, 30vmax 70vmax;
        }
        75% {
            background-size: 90vmax 90vmax, 90vmax 90vmax, 100vmax 100vmax, 90vmax 90vmax, 70vmax 70vmax;
            background-position: -50vmax -40vmax, 50vmax -30vmax, 20vmax 0vmax, -10vmax 10vmax, 40vmax 60vmax;
        }
    }

    .collection .content {
        display: flex;
        justify-content: space-around;
        height: 100%;
    }

    .collection .content > div {
        margin: auto 0;
    }

    .left .intro {
        max-width: 300px;
    }

    .right .icon {
        margin: 5px;
        height: 50px;
        border-radius: 5px;
        transition: all .2s ease-out;
        cursor: pointer;
    }

    .right .icon:hover {
        transform: scale(1.3);
    }
</style>